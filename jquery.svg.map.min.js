(function(h){var y=function(r,n){var s=h(r),t=!1,u=!1,g={},a,f,k,v,w=!0,d=h.extend({zoomLevels:20,buttonsAdditionalClass:"",plusButtonText:"+",minusButtonText:"-",enableConsoleOutput:!1},n||{}),l,p,q=0,m=1;this.disableDragging=function(){w=!1};this.enableDragging=function(){w=!0};this.getCurrentZoomLevel=function(){return q};this.getCurrentZoomRatio=function(){return m};var y=function(){f.onselectstart=function(){return!1};f.unselectable="on";a.css("user-select","none");a.css("-o-user-select","none");
a.css("-moz-user-select","none");a.css("-khtml-user-select","none");a.css("-webkit-user-select","none")},z=function(b){var e=x(b,f);a.trigger("svg_map.move",[e]);u=!0;if(w&&t){var c=b.offsetX;b=b.offsetY;a.css("cursor","move");var d=(f.getAttribute("viewBox")||"0 0 "+a.width()+" "+a.height()).split(" ");f.setAttribute("viewBox",[(g.x-g.xOffset-c)/m,(g.y-g.yOffset-b)/m,d[2],d[3]].join(" "));a.trigger("svg_map.drag",[e])}},A=function(b){var e=x(b,f);t=!0;u=!1;var c=(f.getAttribute("viewBox")||"0 0 0 0").split(" ");
g={x:b.offsetX,y:b.offsetY,xOffset:-1*c[0],yOffset:-1*c[1]};a.trigger("svg_map.mousedown",[e,g])},B=function(b){b=x(b,f);!1===u&&a.trigger("svg_map.click",[b]);t=!1;a.css("cursor","auto");a.trigger("svg_map.mouseup",[b])},x=function(b,a){k.x=b.clientX;k.y=b.clientY;return null===a?k.matrixTransform(f.getScreenCTM().inverse()):k.matrixTransform(a.getScreenCTM().inverse())},C=function(b){var e=h(b.target).data("zoom");!0===d.enableConsoleOutput&&(console.group("SVG Zoom"),console.log("zoomFactor",e));
b=(f.getAttribute("viewBox")||"0 0 "+a.width()+" "+a.height()).split(" ");var c=b[2],g=b[3];q=Math.round((a.width()-c)/Math.round(l)+1);m=d.zoomLevels/(d.zoomLevels-q);!0===d.enableConsoleOutput&&(console.log("currentWidth",c),console.log("currentHeight",g),console.log("currentZoomLevel",q),console.log("currentZoomRatio",m));!0===d.enableConsoleOutput&&(console.log("zoomStepWidth",l),console.log("zoomStepHeight",p));c/=l;g/=p;!0===d.enableConsoleOutput&&(console.log("currentStepWidth",c),console.log("currentStepHeight",
g));c=l*(c+e);e=p*(g+e);!0===d.enableConsoleOutput&&(console.log("newWidth",c),console.log("newHeight",e));1>c&&(c=1);1>e&&(e=1);!0===d.enableConsoleOutput&&console.groupEnd();b=[b[0],b[1],Math.floor(c),Math.floor(e)];f.setAttribute("viewBox",b.join(" "));a.trigger("svg_map.zoom",[b])};(function(b){a=h(b);f=a.get(0);k=f.createSVGPoint();y();a.wrap('<section id="svg_map_wrapper" style="position: relative; width: '+a.width()+"px; height: "+a.height()+'px;" />');v=h("#svg_map_wrapper");b=h('<button class="zoom_button '+
d.buttonsAdditionalClass+'" type="button" id="zoom_in" data-zoom="-1">'+d.plusButtonText+"</button>");var e=h('<button class="zoom_button '+d.buttonsAdditionalClass+'" type="button" id="zoom_out" data-zoom="1">'+d.minusButtonText+"</button>"),c=h('<aside class="zoom_button_container" style="z-index: 999;" />');c.css({position:"absolute",top:0,right:0});c.append(b);c.append(e);v.prepend(c);l=a.width()/d.zoomLevels;p=a.height()/d.zoomLevels;v.find(".zoom_button").on("click",C);a.on("mousedown",A);a.on("mouseup",
B);a.on("mousemove",z);a.trigger("svg_map.init")})(s)};h.fn.svgMap=function(r){return this.filter("svg").each(function(){var n=h(this);if(!n.data("svgmap")){var s=new y(this,r);n.data("svgmap",s)}})}})(jQuery);
